<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Robust Clustering via NMF (non-negative matrix factorization) — nmfClustering • SpatialEcoTyper</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Robust Clustering via NMF (non-negative matrix factorization) — nmfClustering"><meta name="description" content="When one rank is provided, NMF clustering will be performed. When multiple ranks
are provided, this function will determine the optimal number of communities (K)
by assessing the cophenetic coefficient across different values of K."><meta property="og:description" content="When one rank is provided, NMF clustering will be performed. When multiple ranks
are provided, this function will determine the optimal number of communities (K)
by assessing the cophenetic coefficient across different values of K."><meta property="og:image" content="https://digitalcytometry.github.io/spatialecotyper/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SpatialEcoTyper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/SingleSample.html">Discovery of Spatial Ecotypes from a Single Sample</a></li>
    <li><a class="dropdown-item" href="../articles/Integration.html">Discovery of Spatial Ecotypes from Multiple Samples</a></li>
    <li><a class="dropdown-item" href="../articles/TrainRecoveryModels.html">Development of NMF Models for Spatial Ecotype Recovery</a></li>
    <li><a class="dropdown-item" href="../articles/Recovery_scRNA.html">Recovery of Spatial Ecotypes from Single-Cell Gene Expression Data</a></li>
    <li><a class="dropdown-item" href="../articles/Recovery_Bulk.html">Recovery of Spatial Ecotypes from Bulk Gene Expression Data</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">R functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/digitalcytometry/spatialecotyper" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Robust Clustering via NMF (non-negative matrix factorization)</h1>
      <small class="dont-index">Source: <a href="https://github.com/digitalcytometry/spatialecotyper/blob/main/R/nmfClustering.R" class="external-link"><code>R/nmfClustering.R</code></a></small>
      <div class="d-none name"><code>nmfClustering.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When one rank is provided, NMF clustering will be performed. When multiple ranks
are provided, this function will determine the optimal number of communities (K)
by assessing the cophenetic coefficient across different values of K.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmfClustering</span><span class="op">(</span></span>
<span>  <span class="va">mat</span>,</span>
<span>  ranks <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  nrun.per.rank <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  min.coph <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  nmf.method <span class="op">=</span> <span class="st">"brunet"</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mat">mat<a class="anchor" aria-label="anchor" href="#arg-mat"></a></dt>
<dd><p>Numeric matrix (feature by sample) for clustering analysis.</p></dd>


<dt id="arg-ranks">ranks<a class="anchor" aria-label="anchor" href="#arg-ranks"></a></dt>
<dd><p>Numeric vector specifying the number of clusters to evaluate.</p></dd>


<dt id="arg-nrun-per-rank">nrun.per.rank<a class="anchor" aria-label="anchor" href="#arg-nrun-per-rank"></a></dt>
<dd><p>Integer specifying the number of runs per rank for clustering.</p></dd>


<dt id="arg-min-coph">min.coph<a class="anchor" aria-label="anchor" href="#arg-min-coph"></a></dt>
<dd><p>Numeric specifying the minimum cophenetic coefficient required for a rank to be optimal.</p></dd>


<dt id="arg-nmf-method">nmf.method<a class="anchor" aria-label="anchor" href="#arg-nmf-method"></a></dt>
<dd><p>Character string specifying the method for NMF analysis.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Integer specifying the number of CPU cores to use for parallel processing.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical indicating whether to plot the results.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer used to seed the random number generator for NMF analysis.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to the nmf function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An NMFfitX1 object when only one rank is provided. A list containing
the optimal number of communities (bestK), a list of NMFfitX1 objects (NMFfits), and a ggplot
object (p) displaying the cophenetic coefficient across different values of K.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://renozao.github.io/NMF/" class="external-link">NMF</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://digitalcytometry.github/spatialecotyper" class="external-link">SpatialEcoTyper</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat</span><span class="op">[</span><span class="va">mat</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specify one rank</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">nmfClustering</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">mat</span>, ranks <span class="op">=</span> <span class="fl">3</span>, nrun.per.rank <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 3 2 2 3 2 2 2 2 3 1 1 1 1 3 1 2 3 3 3 2 2 2 2 1 2 1 3 3 3 3 2 3 1 3 3 2 3 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 1 2 2 3 3 1 3 2 1 3 3 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"what")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 1 2 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Determine optimal ranks by testing multiple ranks</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">nmfClustering</span><span class="op">(</span>mat <span class="op">=</span> <span class="va">mat</span>, ranks <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>, nrun.per.rank <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">$</span><span class="va">p</span></span></span>
<span class="r-plt img"><img src="nmfClustering-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">result</span><span class="op">$</span><span class="va">bestK</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">NMFfits</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"K."</span>, <span class="va">result</span><span class="op">$</span><span class="va">bestK</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 2 1 1 1 1 1 2 2 2 2 1 2 2 1 1 2 2 1 1 1 2 2 1 2 1 2 1 1 1 2 2 2 1 1 2 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] 2 1 2 1 1 2 2 1 2 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"what")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 1 2</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://profiles.stanford.edu/wubing-zhang" class="external-link">Wubing Zhang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

